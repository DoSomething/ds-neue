!function(){"use strict";_.templateSettings={evaluate:/\{\{#([\s\S]+?)\}\}/g,interpolate:/\{\{[^#\{]([\s\S]+?)[^\}]\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g},window.DS=window.DS||{},window.DS.State=window.DS.State||{},window.DS.State.Server=DS.State.Server||{},window.DS.State.App=DS.State.App||{}}(),function(a){"use strict";window.DS=window.DS||{},window.DS.Auth=window.NEUE.BaseModule.extend({defaultOptions:{initialColor:"pink"},Events:{".js-example-module-color-btn click":"showColor"},State:{color:""},Templates:{colorView:"#template--example-color"},_initialize:function(){var b=this;_.bindAll(this,"setColor","showColor","resetColor"),this.Views.$colorView=a("<div/>",{className:"color-container"}),this.State.color=this.Options.initialColor,a(document).ready(function(){b.Views.$colorView.appendTo(b.$el)})},setColor:function(a){this.State.color=a},showColor:function(){this.Views.$colorView.html(this.Templates.colorView({color:this.State.color}))},resetColor:function(){this.State.color=this.Options.initialColor}})}(jQuery),function(a){"use strict";window.DS=window.DS||{},window.DS.LocationFinder=window.NEUE.BaseModule.extend({defaultOptions:{url:"/example-data.json",validation:/(^\d{5}$)/},Events:{".js-location-finder-toggle-form click":"toggleFormType",".js-location-finder-submit click":"findLocation",".js-location-finder-form submit":"findLocation",".js-location-finder-reset-form click":"resetForm"},State:{mode:"zip",searchTerm:""},Templates:{searchViewGeo:"#template--locfinder-geo",searchViewZip:"#template--locfinder-zip",resultsView:"#template--locfinder-results",locationResult:"#template--locfinder-location"},_initialize:function(){var b=this;_.bindAll(this,"queryZip","queryGeolocation","geolocationError","printResults"),this.Views.$formView=a("<div/>",{className:"locfinder-form"}),this.Views.$resultsView=a("<div/>",{className:"locfinder-results"}),a(document).ready(function(){b.Views.$formView.appendTo(b.$el),b.Views.$resultsView.appendTo(b.$el),Modernizr.geolocation?(b.Views.$formView.html(b.Templates.searchViewGeo),b.State.mode="geo"):(b.Views.$formView.html(b.Templates.searchViewZip),b.State.mode="zip")})},toggleFormType:function(){"zip"===this.State.mode?(this.State.mode="geo",this.Views.$formView.html(this.Templates.searchViewGeo)):(this.State.mode="zip",this.Views.$formView.html(this.Templates.searchViewZip))},findLocation:function(){this.initialized&&(this.Views.$formView.find(".js-location-finder-submit").addClass("loading"),"zip"===this.State.mode?this.queryZip():navigator.geolocation.getCurrentPosition(this.queryGeolocation,this.geolocationError))},queryZip:function(){var b=this,c=this.Views.$formView.find("input[name='zip']").val();c.match(this.Options.validation)?(this.State.searchTerm=c,a.get(this.Options.url+"?zip="+c).done(function(a){b.printResults(a)}).fail(function(){b.showError("There was a network error. Double-check that you have internet?")})):this.showError("Hmm, make sure you entered a valid zip code.")},queryGeolocation:function(b){var c=this,d=b.coords.latitude,e=b.coords.longitude;this.State.searchTerm="your location",a.get(this.Options.url+"?latitude="+d+"&longitude="+e).done(function(a){c.printResults(a)}).fail(function(){c.showError("There was a network error. Double-check that you have internet?")})},geolocationError:function(a){1===a.code?this.showError("Sorry, it seems like you might have refused to share your location with us. Try using a zip code instead?"):this.showError("We couldn't find your location because of a network error.")},showError:function(a){this.Views.$formView.find(".js-location-finder-submit").removeClass("loading"),this.Views.$resultsView.slideUp(),this.Views.$resultsView.html('<div class="messages error">'+a+"</div>"),this.Views.$resultsView.slideDown()},printResults:function(a){var b=this;this.Views.$resultsView.slideUp(function(){b.Views.$resultsView.html(b.Templates.resultsView({searchTerm:b.State.searchTerm})),_.each(a.results,function(a){b.Views.$resultsView.find(".js-location-finder-results").append(b.Templates.locationResult(a))}),b.Views.$formView.slideUp(),b.Views.$resultsView.slideDown(function(){b.Views.$formView.find(".js-location-finder-submit").removeClass("loading")})})},resetForm:function(){this.Views.$resultsView.slideUp(),this.Views.$formView.slideDown()}})}(jQuery);